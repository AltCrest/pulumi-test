# main.yaml (OIDC-enabled version)

name: main

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  pulumi-up:
    name: pulumi-up
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # ... (Node.js and Install steps remain the same) ...

      - uses: pulumi/actions@v5
        with:
          # Note: Changed command to 'up' for a typical deployment
          command: up
          stack-name: Stacks/static-website-aws-typescript/dev
          work-dir: ./static-website-aws-typescript
        env:
          # This is still required to authenticate to Pulumi Cloud
          PULUMI_ACCESS_TOKEN: ${{ secrets.PULUMI_ACCESS_TOKEN }}
